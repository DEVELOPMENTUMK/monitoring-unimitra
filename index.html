<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Monitoring Terpadu - Commers</title>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .main-wrapper { max-width: 1100px; margin: auto; }
        
        /* Menu Utama */
        .menu-grid { display: flex; gap: 20px; justify-content: center; margin-top: 50px; }
        .menu-card { background: white; padding: 30px; border-radius: 15px; text-align: center; width: 250px; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.05); transition: 0.3s; }
        .menu-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .menu-card img { width: 60px; margin-bottom: 15px; }
        .menu-card h3 { color: #2563eb; margin: 10px 0; }
        
        /* Form & Tabel */
        .content-section { background: white; padding: 30px; border-radius: 12px; display: none; box-shadow: 0 2px 15px rgba(0,0,0,0.1); }
        .header-doc { font-family: 'Times New Roman', serif; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
        
        .grid-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; }
        input, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        textarea { height: 70px; }

        /* Checkbox DROP */
        .drop-box { display: flex; align-items: center; gap: 10px; background: #fff1f2; padding: 12px; border-radius: 6px; border: 1px solid #fecdd3; margin-bottom: 20px; }
        
        .btn-group { display: flex; gap: 10px; margin-bottom: 30px; }
        button { padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; flex: 1; }
        .btn-save { background: #16a34a; color: white; }
        .btn-word { background: #2b5797; color: white; }
        .btn-print { background: #333; color: white; }
        .btn-back { background: #64748b; color: white; margin-bottom: 20px; }

        /* Table Style */
        table { width: 100%; border-collapse: collapse; font-family: 'Times New Roman', serif; }
        th, td { border: 1px solid black; padding: 10px; text-align: left; }
        th { background: #f3f4f6; text-align: center; }
        .row-red { background-color: #fecdd3 !important; color: #991b1b; font-weight: bold; }

        @media print { .no-print { display: none !important; } .content-section { display: block !important; box-shadow: none; padding: 0; } }
    </style>
</head>
<body>

<div class="main-wrapper">
    
    <div id="mainMenu" class="menu-grid no-print">
        <div class="menu-card" onclick="alert('Menu Vendor Terpilih')">
            <img src="https://cdn-icons-png.flaticon.com/512/1250/1250615.png" alt="Vendor">
            <h3>Input Data Vendor</h3>
            <p>Monitoring Development</p>
        </div>
        <div class="menu-card" onclick="bukaCommers()">
            <img src="https://cdn-icons-png.flaticon.com/512/3502/3502688.png" alt="Commers">
            <h3>Commers</h3>
            <p>(Klik untuk Masuk)</p>
        </div>
    </div>

    <div id="commersSection" class="content-section">
        <button class="btn-back no-print" onclick="kembaliMenu()">‚Üê Kembali ke Menu Utama</button>
        
        <div class="no-print">
            <h2 style="color: #2563eb; text-align: center;">INPUT DATA COMMERS</h2>
            <div class="grid-form">
                <div><label>Tanggal</label><input type="date" id="f_tgl"></div>
                <div><label>Proyek</label><input type="text" id="f_proy"></div>
            </div>
            <div class="grid-form">
                <div><label>Detail Pekerjaan</label><textarea id="f_kerja"></textarea></div>
                <div>
                    <label>Catatan</label>
                    <textarea id="f_catat" placeholder=""></textarea>
                </div>
            </div>
            
            <label class="drop-box">
                <input type="checkbox" id="f_isDrop">
                <span style="color: #be123c; font-weight: bold;">Tandai sebagai "DROP" (Baris Merah)</span>
            </label>

            <div class="btn-group">
                <button class="btn-save" onclick="simpanKeTabel()">SIMPAN DATA</button>
                <button class="btn-word" onclick="unduhWord()">SIMPAN KE WORD</button>
                <button class="btn-print" onclick="window.print()">PRINT JURNAL</button>
            </div>
        </div>

        <div id="areaPrint">
            <div class="header-doc">
                <p>Nama &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Arif Setiawan</p>
                <p>NIK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 2040412</p>
                <p>Bagian &nbsp;&nbsp;&nbsp;: Development</p>
                <h3 style="text-align: center; text-decoration: underline; margin-top: 30px;">JURNAL KERJA HARIAN 2026</h3>
            </div>

            <table>
                <thead>
                    <tr>
                        <th width="40">No.</th>
                        <th width="120">Tanggal</th>
                        <th>Proyek dan Detail Pekerjaan</th>
                        <th width="200">Catatan</th>
                        <th width="80" class="no-print">Aksi</th>
                    </tr>
                </thead>
                <tbody id="isiTabel">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    let dbCommers = JSON.parse(localStorage.getItem('data_commers_2026')) || [];
    let editIdx = -1;

    function bukaCommers() {
        document.getElementById('mainMenu').style.display = 'none';
        document.getElementById('commersSection').style.display = 'block';
        tampilkanData();
    }

    function kembaliMenu() {
        document.getElementById('mainMenu').style.display = 'flex';
        document.getElementById('commersSection').style.display = 'none';
    }

    function simpanKeTabel() {
        const checkDrop = document.getElementById('f_isDrop').checked;
        let catatanFix = document.getElementById('f_catat').value;
        
        // Logika penambahan kata DROP untuk trigger warna
        if(checkDrop && !catatanFix.includes('DROP')) catatanFix += " DROP";

        const dataBaru = {
            tgl: document.getElementById('f_tgl').value,
            proy: document.getElementById('f_proy').value,
            kerja: document.getElementById('f_kerja').value,
            catat: catatanFix
        };

        if(!dataBaru.tgl || !dataBaru.proy) return alert("Mohon isi Tanggal dan Proyek!");

        if(editIdx === -1) {
            dbCommers.push(dataBaru);
        } else {
            dbCommers[editIdx] = dataBaru;
            editIdx = -1;
        }

        localStorage.setItem('data_commers_2026', JSON.stringify(dbCommers));
        resetInput();
        tampilkanData();
    }

    function tampilkanData() {
        const tbody = document.getElementById('isiTabel');
        tbody.innerHTML = '';
        
        dbCommers.forEach((item, i) => {
            const isRed = item.catat.toUpperCase().includes('DROP') ? 'row-red' : '';
            const tglIndo = item.tgl.split('-').reverse().join('/');
            
            tbody.innerHTML += `
                <tr class="${isRed}">
                    <td align="center">${i + 1}</td>
                    <td align="center">${tglIndo}</td>
                    <td><strong>${item.proy}</strong><br>${item.kerja}</td>
                    <td>${item.catat}</td>
                    <td class="no-print" align="center">
                        <span onclick="editData(${i})" style="color:blue; cursor:pointer;">Edit</span> | 
                        <span onclick="hapusData(${i})" style="color:red; cursor:pointer;">Hapus</span>
                    </td>
                </tr>
            `;
        });
    }

    function editData(i) {
        const d = dbCommers[i];
        document.getElementById('f_tgl').value = d.tgl;
        document.getElementById('f_proy').value = d.proy;
        document.getElementById('f_kerja').value = d.kerja;
        document.getElementById('f_catat').value = d.catat.replace(' DROP', '');
        document.getElementById('f_isDrop').checked = d.catat.includes('DROP');
        editIdx = i;
        window.scrollTo(0,0);
    }

    function hapusData(i) {
        if(confirm("Hapus baris ini?")) {
            dbCommers.splice(i, 1);
            localStorage.setItem('data_commers_2026', JSON.stringify(dbCommers));
            tampilkanData();
        }
    }

    function resetInput() {
        document.getElementById('f_tgl').value = '';
        document.getElementById('f_proy').value = '';
        document.getElementById('f_kerja').value = '';
        document.getElementById('f_catat').value = '';
        document.getElementById('f_isDrop').checked = false;
    }

    function unduhWord() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><style>table{border-collapse:collapse; width:100%;} th,td{border:1px solid black; padding:5px;} .row-red{background-color:#fecdd3;}</style></head><body>";
        const body = document.getElementById('areaPrint').innerHTML;
        const footer = "</body></html>";
        
        const blob = new Blob(['\ufeff', header + body + footer], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Jurnal_Kerja_2026.doc';
        link.click();
    }
</script>

</body>
</html>
