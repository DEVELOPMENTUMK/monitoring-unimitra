<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnal Kerja Harian - Arif Setiawan</title>
    
    <style>
        /* Gaya Visual Utama */
        body { font-family: 'Times New Roman', Times, serif; background: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        .wrapper { max-width: 1100px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        /* Header Form */
        .no-print h2 { text-align: center; color: #1a73e8; margin-top: 0; }
        .input-section { background: #f9f9f9; padding: 20px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 30px; }
        
        /* Grid Input */
        .grid-input { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { display: block; font-weight: bold; font-size: 14px; margin-bottom: 5px; }
        input, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-family: inherit; }
        textarea { height: 60px; resize: vertical; }

        /* Tombol */
        .btn-area { display: flex; gap: 10px; }
        button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-save { background: #28a745; color: white; flex: 2; }
        .btn-word { background: #2b5797; color: white; }
        .btn-print { background: #333; color: white; }
        button:hover { opacity: 0.8; }

        /* Desain Dokumen (Sesuai Gambar) */
        .doc-header { margin-bottom: 20px; line-height: 1.2; }
        .doc-header p { margin: 5px 0; font-size: 16px; }
        .title-jurnal { text-align: center; text-decoration: underline; margin: 20px 0; font-size: 20px; font-weight: bold; }

        /* Tabel Sesuai Gambar */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid black; padding: 8px; text-align: left; vertical-align: top; }
        th { background: #eeeeee; text-align: center; }
        
        /* Fitur Baris DROP (Merah) */
        .row-drop { background-color: #ffcccc !important; color: #b71c1c; font-weight: bold; }

        /* Aksi */
        .actions { display: flex; gap: 5px; justify-content: center; }
        .btn-edit { background: #ffc107; padding: 4px 8px; font-size: 11px; border-radius: 3px; }
        .btn-delete { background: #dc3545; color: white; padding: 4px 8px; font-size: 11px; border-radius: 3px; }

        /* Pengaturan Print */
        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .wrapper { box-shadow: none; width: 100%; padding: 0; }
            th { background: #eee !important; -webkit-print-color-adjust: exact; }
            .row-drop { background-color: #ffcccc !important; -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="no-print">
        <h2>Menu Commers - Input Jurnal</h2>
        <div class="input-section">
            <input type="hidden" id="editIndex" value="-1">
            <div class="grid-input">
                <div>
                    <label>Tanggal</label>
                    <input type="date" id="tgl">
                </div>
                <div>
                    <label>Proyek</label>
                    <input type="text" id="proy" placeholder="Nama proyek...">
                </div>
            </div>
            <div class="grid-input">
                <div>
                    <label>Detail Pekerjaan</label>
                    <textarea id="kerj" placeholder="Apa yang dikerjakan..."></textarea>
                </div>
                <div>
                    <label>Catatan</label>
                    <textarea id="catat" placeholder=""></textarea>
                </div>
            </div>
            <div class="btn-area">
                <button class="btn-save" onclick="olahData()">SIMPAN KE TABEL</button>
                <button class="btn-word" onclick="exportWord()">SIMPAN KE WORD</button>
                <button class="btn-print" onclick="window.print()">PRINT</button>
            </div>
        </div>
    </div>

    <div id="dokumenArea">
        <div class="doc-header">
            <p>Nama &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Arif Setiawan</p>
            <p>NIK &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 2040412</p>
            <p>Bagian &nbsp;&nbsp;&nbsp;: Development</p>
        </div>

        <div class="title-jurnal">JURNAL KERJA HARIAN 2026</div>

        <table id="tabelJurnal">
            <thead>
                <tr>
                    <th width="40">No.</th>
                    <th width="120">Tanggal</th>
                    <th>Proyek dan Detail Pekerjaan</th>
                    <th width="200">Catatan</th>
                    <th width="100" class="no-print">Aksi</th>
                </tr>
            </thead>
            <tbody id="isiTabel">
                </tbody>
        </table>
    </div>
</div>

<script>
    // Inisialisasi Data dari Penyimpanan Browser
    let listJurnal = JSON.parse(localStorage.getItem('db_jurnal_2026')) || [];

    function tampilkanData() {
        const tabel = document.getElementById('isiTabel');
        tabel.innerHTML = '';
        
        listJurnal.forEach((data, i) => {
            // Logika Baris Merah jika ada kata "DROP"
            const statusDrop = data.catatan.toUpperCase().includes('DROP') ? 'row-drop' : '';
            
            tabel.innerHTML += `
                <tr class="${statusDrop}">
                    <td align="center">${i + 1}</td>
                    <td align="center">${formatTanggal(data.tanggal)}</td>
                    <td><b>${data.proyek}</b><br>${data.pekerjaan}</td>
                    <td>${data.catatan}</td>
                    <td class="no-print actions">
                        <button class="btn-edit" onclick="siapkanEdit(${i})">Edit</button>
                        <button class="btn-delete" onclick="hapusData(${i})">Hapus</button>
                    </td>
                </tr>
            `;
        });
        localStorage.setItem('db_jurnal_2026', JSON.stringify(listJurnal));
    }

    function olahData() {
        const idx = document.getElementById('editIndex').value;
        const info = {
            tanggal: document.getElementById('tgl').value,
            proyek: document.getElementById('proy').value,
            pekerjaan: document.getElementById('kerj').value,
            catatan: document.getElementById('catat').value
        };

        if(!info.tanggal || !info.proyek) return alert("Tanggal dan Proyek wajib diisi!");

        if(idx === "-1") {
            listJurnal.push(info);
        } else {
            listJurnal[idx] = info;
            document.getElementById('editIndex').value = "-1";
        }

        bersihkanForm();
        tampilkanData();
    }

    function siapkanEdit(i) {
        const d = listJurnal[i];
        document.getElementById('tgl').value = d.tanggal;
        document.getElementById('proy').value = d.proyek;
        document.getElementById('kerj').value = d.pekerjaan;
        document.getElementById('catat').value = d.catatan;
        document.getElementById('editIndex').value = i;
        window.scrollTo(0,0);
    }

    function hapusData(i) {
        if(confirm("Hapus baris ini?")) {
            listJurnal.splice(i, 1);
            tampilkanData();
        }
    }

    function bersihkanForm() {
        document.getElementById('tgl').value = '';
        document.getElementById('proy').value = '';
        document.getElementById('kerj').value = '';
        document.getElementById('catat').value = '';
    }

    function formatTanggal(tgl) {
        if(!tgl) return "";
        const part = tgl.split('-');
        return `${part[2]}/${part[1]}/${part[0]}`;
    }

    // Fungsi Export ke Word (Metode Blob)
    function exportWord() {
        const header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><title>Export Word</title><style>table{border-collapse:collapse; width:100%;} th,td{border:1px solid black; padding:5px;} .row-drop{background-color:#ffcccc;}</style></head><body>";
        const footer = "</body></html>";
        const html = header + document.getElementById('dokumenArea').innerHTML + footer;

        const blob = new Blob(['\ufeff', html], { type: 'application/msword' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'Jurnal_Kerja_ArifSetiawan_2026.doc';
        link.click();
    }

    // Jalankan saat pertama buka
    tampilkanData();
</script>

</body>
</html>
